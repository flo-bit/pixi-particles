<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />
  </head>

  <body style="overflow: hidden; background-color: black">
    <script type="module">
      import PixiScaffold from "https://flo-bit.github.io/pixi-scaffold/pixi-scaffold.js";
      import Particles from "../particles.js";

      class Game {
        setup() {
          this.rect = new PIXI.Graphics();
          this.rect.beginFill(0x0000aa);
          this.rect.drawRect(-PS.w / 2, -PS.h / 2, PS.w, PS.h);
          this.rect.endFill();
          this.rect.alpha = 0.2;
          PS.addChild(this.rect);

          this.text = new PIXI.Text("1000", {
            fontFamily: "Arial",
            fontSize: 35,
            fill: 0xffffff,
            align: "left",
          });
          this.text.anchor.x = 1;
          this.text.x = PS.w / 2 - 10;
          this.text.y = PS.h / 2 - 50;
          PS.addChild(this.text);

          this.particles = new Particles({ renderer: PS.app.renderer });
          PS.addChild(this.particles);
        }
        update(dt, total) {
          this.text.text = this.particles.children.length;
          this.particles.update(dt);
          // spawn 10 particles from 0, 0 with random velocity and a lifetime of 2-3 seconds
          this.particles.spawn({
            x: 0,
            y: 0,
            vx: () => (Math.random() - 0.5) * 500,
            vy: () => (Math.random() - 0.5) * 500,
            count: 10,
            life: Math.random() + 2,
            drag: 0.99,
          });
        }
      }
      let game = new Game();
      let app = new PixiScaffold(game);
    </script>
  </body>
</html>
